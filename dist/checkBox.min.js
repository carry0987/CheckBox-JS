!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).CheckBox=t()}(this,(function(){"use strict";const e={getElem:(e,t,c)=>"object"==typeof e?e:void 0===t&&void 0===c?isNaN(1*e)?document.querySelector(e):document.getElementById(e):"all"===t||null===t?void 0===c?document.querySelectorAll(e):c.querySelectorAll(e):"object"==typeof t&&void 0===c?t.querySelector(e):void 0,isObject:e=>e&&"object"==typeof e&&!Array.isArray(e),deepMerge(t,...c){const n=c.shift();if(!n)return t;if(e.isObject(t)&&e.isObject(n))for(const c in n)e.isObject(n[c])?(t[c]||Object.assign(t,{[c]:{}}),e.deepMerge(t[c],n[c])):Object.assign(t,{[c]:n[c]});return e.deepMerge(t,...c)},createEvent(e){let t;return window.CustomEvent&&"function"==typeof window.CustomEvent?t=new CustomEvent(e):(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!1,!1,void 0)),t},removeItem(e,t){let c,n=arguments,o=n.length;for(;o&&e.length;)for(t=n[--o];-1!==(c=e.indexOf(t));)e.splice(c,1);return e},injectStylesheet(t,c){let n=document.createElement("style");n.id="checkbox-style"+c,n.appendChild(document.createTextNode("")),document.head.appendChild(n);let o=document.styleSheets[document.styleSheets.length-1];for(let n in t)t.hasOwnProperty(n)&&e.compatInsertRule(o,n,e.buildRules(t[n]),c)},buildRules(e){let t="";for(let[c,n]of Object.entries(e))t+=`${c}:${n};`;return t},compatInsertRule(e,t,c,n){let o=t.replace(".check-box",".check-box-"+n);e.insertRule(o+"{"+c+"}",0)},removeStylesheet(t){let c=e.getElem("#checkbox-style"+t);c&&c.parentNode.removeChild(c)},createUniqueID:(e=8)=>Math.random().toString(36).substring(2,2+e),getTemplate:e=>`\n        <div class="checkbox check-box-${e}">\n            <label class="checkbox-label"></label>\n        </div>\n        `,isEmpty:e=>!e?.length,toggleCheckAll(t,c){let n=e.getElem(t);n&&(c&&c.checked&&c.row?(n.checked=c.checked===c.row&&0!==c.checked,n.setAttribute("checked",n.checked?"checked":null)):(n.checked=!1,n.removeAttribute("checked")))}};class t{constructor(e,c={}){this.init(e,c,t.instance.length),t.instance.push(this),1===t.instance.length&&function(e,t=!1){!0===t?console.log("Data Type : "+typeof e,"\nValue : "+e):"boolean"!=typeof t?console.log(t):console.log(e)}("CheckBox is loaded, version:"+t.version)}static destroyAll(){t.instance.forEach((e=>{e.destroy()})),t.instance=[]}init(c,n,o){let i=e.getElem(c,"all");if((!i||i.length<1)&&function(e){throw new Error(e)}("Cannot find elements : "+c),this.id=o,this.element=c,this.allElement=[],this.option=e.deepMerge({},t.defaultOption,n),this.total={checked:[],list:[],input:[],row:0},this.option?.styles&&Object.keys(this.option.styles).length>0){let t=e.deepMerge({},this.option.styles);e.injectStylesheet(t,this.id)}if(e.toggleCheckAll(this.option.checkAll,this.total),this.onChange=e=>{this.option?.onChange&&this.option.onChange(e)},i.forEach(((t,c)=>{if("checkbox"!==t.type)return;if(t.hasAttribute("data-checkbox"))return;t.setAttribute("data-checkbox","true");let n=t.nextElementSibling,o=t?.title||t?.dataset?.checkboxTitle,l=this.option.bindLabel,h=!1,s=null;n&&"LABEL"===n.tagName&&(o=(()=>{if(!e.isEmpty(t.id)){if(n.htmlFor===t.id)return l=h=!0,!0;if(n.dataset?.checkboxFor===t.id)return!0}return t.dataset?.checkboxId&&n.dataset?.checkboxFor===t.dataset?.checkboxId?(s=e.isEmpty(t.id)&&e.isEmpty(n.htmlFor)?"check-"+e.createUniqueID(6):null,!0):null})(),!0===o&&(o=n.textContent,n.parentNode.removeChild(n))),t.checked?t.setAttribute("checked","checked"):this.option?.checked&&("boolean"==typeof this.option.checked&&1===i.length&&(t.checked=!0,t.setAttribute("checked","checked")),t?.value!==this.option.checked&&c!==this.option.checked||(t.checked=!0,t.setAttribute("checked","checked")),"string"==typeof this.option.checked&&(this.option.checked=[this.option.checked]),Array.isArray(this.option.checked)&&(this.option.checked.includes(t.name)||this.option.checked.includes(t.id))&&(t.checked=!0,t.setAttribute("checked","checked")));let r=e.getTemplate(this.id),d=document.createElement("div");d.innerHTML=r.trim();let a=e.getElem("label",d),u=t.cloneNode(!0);s&&(u.removeAttribute("data-checkbox-id"),u.id=s,a.htmlFor=s),!0===h&&(a.htmlFor=u.id),a.parentNode.insertBefore(u,a),t.parentNode.replaceChild(d.firstElementChild,t),null===o?a.parentNode.removeChild(a):(a.textContent=o,l&&(a.classList.add("checkbox-labeled"),a.addEventListener("click",(e=>{e.preventDefault(),u.click()})))),u.addEventListener("change",(e=>{this.checkBoxChange()})),this.allElement.push(u)})),this.option?.checkAll){const t=e.getElem(this.option.checkAll);t&&this.allElement.length&&t.addEventListener("change",(e=>{const t=e.target.checked;this.allElement.forEach((e=>{e.checked=t,t?e.setAttribute("checked","checked"):e.removeAttribute("checked")})),this.checkBoxChange()}))}return this}checkBoxChange(){const t=this.total;let c=this.element+" input[type=checkbox]:checked";t.checked=Array.from(e.getElem(c,"all")),t.list=[],t.input=[],t.checked.forEach((e=>{t.list.push(e.value),t.input.push(e)})),t.checked=t.checked.length,c=this.element+" input[type=checkbox]",t.row=e.getElem(c,"all").length,e.toggleCheckAll(this.option.checkAll,t),this.onChange(t);const n=e.createEvent("checkbox-change");n.total=t,document.dispatchEvent(n)}getCheckBox(){return this.total}refresh(){this.init(this.element,this.option)}destroy(){return this.allElement.forEach((e=>{e.removeEventListener("change",this.checkBoxChange),e.removeEventListener("change",this.onChange),e.removeEventListener("change",this.option.onChange)})),e.removeStylesheet(this.id),t.instance.splice(this.id,1),this}}return t.version="1.0.0",t.instance=[],t.defaultOption={checkAll:null,onChange:null,onCheckAll:null,bindLabel:!0,styles:{}},t}));
